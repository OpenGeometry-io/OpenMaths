<!doctype html>
<html lang="en-US">
  <head>
    <meta charcreate="UTF-8" />
    <title>hello-wasm example</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,200..900;1,200..900&display=swap" rel="stylesheet">
    <style>
      body {
        font-family: "Source Code Pro", monospace;
        font-optical-sizing: auto;
        font-style: normal;
        margin: 40px;
      }

      .om-header {
        font-size: 1.6rem;
        font-weight: 500;
        padding-top: 20px;
        padding-bottom: 20px;
      }

      .om-span-l {
        font-size: 1.2rem;
        font-weight: 400;
      }

      .om-span-m {
        font-size: 1rem;
        font-weight: 400;
        margin-bottom: 10px;
      }

      .om-span-s {
        font-size: 0.8rem;
        font-weight: 400;
      }

      .om-card {
        margin-top: 20px;
        padding: 20px;
        border-radius: 5px;
        border: 1px solid #2f2f2f;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        position: relative;
      }

      .om-input {
        font-size: 0.8rem;
        font-weight: 400;
        padding: 5px;
        border-radius: 5px;
        border: 1px solid #2f2f2f;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        width: 50px;
      }

      button {
        font-size: 1rem;
        font-weight: 500;
        padding: 10px;
        border-radius: 5px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        background: #4460FF;
        border: none;
        cursor: pointer;
        color: white;
      }

      .result-span{
        position: absolute;
        right: 20px;
        bottom: 20px;
      }
    </style>
  </head>
  <body>
    <p class="om-header">OpenMaths</p>
    
    <!-- Add Vectors -->
    <div class="om-card">
      <span class="om-span-l">Add Vectors</span>
      <br />
      <br />
      <span class="om-span-m">Vector 1</span>
      <br />
      <span class="om-span-s">x</span>
      <input class="om-input" type="number" id="x1" value="0" />

      <span class="om-span-s">y</span>
      <input class="om-input" type="number" id="y1" value="0" />

      <span class="om-span-s">z</span>
      <input class="om-input" type="number" id="z1" value="0" />
      <br />
      <br />
      <span class="om-span-m">Vector 2</span>
      <br />
      <span class="om-span-s">x</span>
      <input class="om-input" type="number" id="x2" value="0" />

      <span class="om-span-s">y</span>
      <input class="om-input" type="number" id="y2" value="0" />

      <span class="om-span-s">z</span>
      <input class="om-input" type="number" id="z2" value="0" />
      <br />
      <br />
      <button onclick="addVector()">Add Vectors</button>
      
      <span class="om-span-m result-span" id="create-vector-eg-id"></span>
    </div>

    <!-- Subtract Vectors -->
    <div class="om-card">
      <span class="om-span-l">Subtract Vectors</span>
      <br />
      <br />
      <span class="om-span-m">Vector 1</span>
      <br />
      <span class="om-span-s">x</span>
      <input class="om-input" type="number" id="sub-x1" value="0" />

      <span class="om-span-s">y</span>
      <input class="om-input" type="number" id="sub-y1" value="0" />

      <span class="om-span-s">z</span>
      <input class="om-input" type="number" id="sub-z1" value="0" />
      <br />
      <br />
      <span class="om-span-m">Vector 2</span>
      <br />
      <span class="om-span-s">x</span>
      <input class="om-input" type="number" id="sub-x2" value="0" />

      <span class="om-span-s">y</span>
      <input class="om-input" type="number" id="sub-y2" value="0" />

      <span class="om-span-s">z</span>
      <input class="om-input" type="number" id="sub-z2" value="0" />
      <br />
      <br />
      <button onclick="subVector()">Subtract Vectors</button>
      
      <span class="om-span-m result-span" id="sub-vector-eg-id"></span>
    </div>

    <!-- Create Polygon from Points -->
    <div class="om-card">
      <span class="om-span-l">Create Polygon from Points</span>
      <br />
      <br />
      <span class="om-span-m">Point 1</span>
      <br />
      <span class="om-span-s">x</span>
      <input class="om-input" type="number" id="p1-x" value="0" />

      <span class="om-span-s">y</span>
      <input class="om-input" type="number" id="p1-y" value="0" />

      <span class="om-span-s">z</span>
      <input class="om-input" type="number" id="p1-z" value="0" />
      <br />
      <br />
      <span class="om-span-m">Point 2</span>
      <br />
      <span class="om-span-s">x</span>
      <input class="om-input" type="number" id="p2-x" value="0" />

      <span class="om-span-s">y</span>
      <input class="om-input" type="number" id="p2-y" value="0" />

      <span class="om-span-s">z</span>
      <input class="om-input" type="number" id="p2-z" value="0" />
      <br />
      <br />
      <span class="om-span-m">Point 3</span>
      <br />
      <span class="om-span-s">x</span>
      <input class="om-input" type="number" id="p3-x" value="0" />

      <span class="om-span-s">y</span>
      <input class="om-input" type="number" id="p3-y" value="0" />

      <span class="om-span-s">z</span>
      <input class="om-input" type="number" id="p3-z" value="0" />
      <br />
      <br />
      <button onclick="prefilVertices()">Prefil Vertices</button>
      <button onclick="createPolygon()">Create Polygon</button>
      <button onclick="updatePolygon()">Update Vertex</button>
      <button onclick="extrudePolygon()">Extrude Polygon</button>
      <span class="om-span-m result-span" id="create-polygon-eg-id"></span>
    </div>

    <script type="module">
      import init, { Vector3D, Polygon } from "./../openmaths-cargo/pkg/openmaths.js";
      init().then((e) => {
        window.addVector = () => {
          const x1 = document.getElementById('x1').value;
          const y1 = document.getElementById('y1').value;
          const z1 = document.getElementById('z1').value;

          const x2 = document.getElementById('x2').value;
          const y2 = document.getElementById('y2').value;
          const z2 = document.getElementById('z2').value;

          const vector1 = Vector3D.create(x1, y1, z1);
          const vector2 = Vector3D.create(x2, y2, z2);

          const result = vector1.add(vector2);

          document.getElementById('create-vector-eg-id').innerText = `Result: x: ${result.x}, y: ${result.y}, z: ${result.z}`;
        };

        window.subVector = () => {
          const x1 = document.getElementById('sub-x1').value;
          const y1 = document.getElementById('sub-y1').value;
          const z1 = document.getElementById('sub-z1').value;

          const x2 = document.getElementById('sub-x2').value;
          const y2 = document.getElementById('sub-y2').value;
          const z2 = document.getElementById('sub-z2').value;

          const vector1 = Vector3D.create(x1, y1, z1);
          const vector2 = Vector3D.create(x2, y2, z2);

          const result = vector1.subtract(vector2);

          document.getElementById('sub-vector-eg-id').innerText = `Result: x: ${result.x}, y: ${result.y}, z: ${result.z}`;
        };

        window.prefilVertices = () => {
          document.getElementById('p1-x').value = 1;
          document.getElementById('p1-y').value = 0;
          document.getElementById('p1-z').value = 1;

          document.getElementById('p2-x').value = 2;
          document.getElementById('p2-y').value = 0;
          document.getElementById('p2-z').value = 2;

          document.getElementById('p3-x').value = -2;
          document.getElementById('p3-y').value = 0;
          document.getElementById('p3-z').value = 1;
        };

        let polygon;
        window.createPolygon = () => {
          const p1x = document.getElementById('p1-x').value;
          const p1y = document.getElementById('p1-y').value;
          const p1z = document.getElementById('p1-z').value;

          const p2x = document.getElementById('p2-x').value;
          const p2y = document.getElementById('p2-y').value;
          const p2z = document.getElementById('p2-z').value;

          const p3x = document.getElementById('p3-x').value;
          const p3y = document.getElementById('p3-y').value;
          const p3z = document.getElementById('p3-z').value;

          const point1 = Vector3D.create(p1x, p1y, p1z);
          const point2 = Vector3D.create(p2x, p2y, p2z);
          const point3 = Vector3D.create(p3x, p3y, p3z);

          polygon = new Polygon();
          polygon.add_vertex(point1);
          polygon.add_vertex(point2);
          polygon.add_vertex(point3);

          // const result = polygon.get_vertex(1);
          // console.log(result);

          // TODO: This is not working
          // polygon.position.x = 10;
          // console.log(polygon.position.x);

          const points = polygon.get_all_vertices();
          console.log(points);
        };

        window.updatePolygon = () => {
          const point1 = Vector3D.create(10, 10, 10);
          polygon.update_vertex(1, point1);
          const points = polygon.get_all_vertices();
          console.log(points);
        };

        window.extrudePolygon = () => {
          // First Set Extrude to true
          // EXTRUDE == MESH here
          const extrude = polygon.set_extrude(true);
          console.log(extrude);

          const copiedPoligonVertices = extrude.get_poligon_vertices();
          console.log(copiedPoligonVertices);

          // Then Extrude the Polygon by Height
          const extrudedPoints = extrude.set_extrude_height(10);
          
          console.log(JSON.parse(extrude.get_geometry()));
        };
      });
    </script>
  </body>
</html>
